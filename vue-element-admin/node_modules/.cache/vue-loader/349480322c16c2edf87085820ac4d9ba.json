{"remainingRequest":"/Users/xixi/staff_management/vue-element-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xixi/staff_management/vue-element-admin/src/views/contract/saveContract.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xixi/staff_management/vue-element-admin/src/views/contract/saveContract.vue","mtime":1608726456325},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":1608726442352},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/babel-loader/lib/index.js","mtime":1608726441374},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":1608726442352},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/vue-loader/lib/index.js","mtime":1608726455182}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjb250cmFjdCBmcm9tICJAL2FwaS9jb250cmFjdCI7CmltcG9ydCBJbWFnZUNyb3BwZXIgZnJvbSAiQC9jb21wb25lbnRzL0ltYWdlQ3JvcHBlciI7CmltcG9ydCBQYW5UaHVtYiBmcm9tICJAL2NvbXBvbmVudHMvUGFuVGh1bWIiOwppbXBvcnQgY2xlcmsgZnJvbSAiQC9hcGkvY2xlcmsiCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IEltYWdlQ3JvcHBlciwgUGFuVGh1bWIgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29udHJhY3Q6IHt9LAogICAgICBzYXZlQnRuRGlzYWJsZWQ6IGZhbHNlLCAvLyDkv53lrZjmjInpkq7mmK/lkKbnpoHnlKgsCiAgICAgIHNhdmVCdG5EaXNhYmxlZDogZmFsc2UsIC8vIOS/neWtmOaMiemSruaYr+WQpuemgeeUqCwKICAgICAgaW1hZ2Vjcm9wcGVyU2hvdzogZmFsc2UsIC8v5LiK5Lyg5by556qX57uE5Lu25piv5ZCm5pi+56S6CiAgICAgIGltYWdlY3JvcHBlcktleTogMCwgLy/kuIrkvKDnu4Tku7bnmoRrZXnlgLwgICAKICAgICAgY2xlcmtMaXN0Om51bGwgIAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICAgIHRoaXMuaW5pdENsZXJrKCk7CiAgfSwKICB3YXRjaDogewogICAgLy/nm5HlkKwKICAgICRyb3V0ZSh0bywgZnJvbSkgewogICAgICAvL+i3r+eUseWPkeeUn+WPmOWMliDmlrnms5XlsLHkvJrmiafooYwKICAgICAgdGhpcy5pbml0KCk7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgY2xvc2UoKSB7CiAgICAgIC8v5YWz6Zet5LiK5Lyg5by55qGG55qE5pa55rOVCiAgICAgIHRoaXMuaW1hZ2Vjcm9wcGVyU2hvdyA9IGZhbHNlOwogICAgICAvL+S4iuS8oOe7hOS7tuWIneWni+WMlgogICAgICB0aGlzLmltYWdlY3JvcHBlcktleSA9IHRoaXMuaW1hZ2Vjcm9wcGVyS2V5ICsgMTsKICAgIH0sCiAgICAvL+S4iuS8oOaIkOWKn+aWueazlQogICAgY3JvcFN1Y2Nlc3MoZGF0YSkgewogICAgICB0aGlzLmltYWdlY3JvcHBlclNob3cgPSBmYWxzZTsKICAgICAgLy/kuIrkvKDkuYvlkI7mjqXlj6Pov5Tlm57lm77niYflnLDlnYAKICAgICAgY29uc29sZS5sb2coZGF0YSk7CiAgICAgIHRoaXMuY29udHJhY3QudXJsID0gZGF0YS51cmw7CiAgICAgIHRoaXMuaW1hZ2Vjcm9wcGVyS2V5ID0gdGhpcy5pbWFnZWNyb3BwZXJLZXkgKyAxOwogICAgfSwKICAgIC8v5Yid5aeL5YyWCiAgICBpbml0KCkgewogICAgICAvL+WIpOaWrei3r+W+hOS4reaYr+WQpuaciWlk5YC8CiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkKSB7CiAgICAgICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgdGhpcy5nZXRDb250cmFjdEJ5SWQoaWQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8v5riF56m66KGo5Y2VCiAgICAgICAgdGhpcy5jb250cmFjdCA9IHt9OwogICAgICB9CiAgICB9LAogICAgLy/mn6Xor6IKICAgIGluaXRDbGVyaygpIHsKICAgICAgY2xlcmsuZ2V0Q2xlcmtMaXN0KCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLmNsZXJrTGlzdCA9IHJlc3BvbnNlLmRhdGEuY2xlcmtMaXN0OwogICAgICB9KTsKICAgIH0sCiAgICAvL+S/ruaUuQogICAgdXBkYXRlQ29udHJhY3QoKSB7CiAgICAgIGNvbnRyYWN0LnVwZGF0ZUNvbnRyYWN0KHRoaXMuY29udHJhY3QpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICBtZXNzYWdlOiAi5L+u5pS55oiQ5YqfISIsCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2NvbnRyYWN0L2xpc3RDb250cmFjdCIgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v5qC55o2uaWTmn6Xor6IKICAgIGdldENvbnRyYWN0QnlJZChpZCkgewogICAgICBjb250cmFjdAogICAgICAgIC5nZXRDb250cmFjdEJ5SWQoaWQpCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICB0aGlzLmNvbnRyYWN0ID0gcmVzcG9uc2UuZGF0YS5jb250cmFjdDsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHt9KTsKICAgIH0sCiAgICBzYXZlT3JVcGRhdGUoKSB7CiAgICAgIC8v5Yik5pat5piv5L+u5pS56L+Y5piv5re75YqgCiAgICAgIC8v5Yik5pat6Lev5b6E5Lit5piv5ZCm5pyJaWQKICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcyAmJiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgICAvL+S/ruaUuQogICAgICAgIHRoaXMudXBkYXRlQ29udHJhY3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL+a3u+WKoAogICAgICAgIHRoaXMuc2F2ZUNvbnRyYWN0KCk7CiAgICAgIH0KICAgIH0sCiAgICAvL+a3u+WKoAogICAgc2F2ZUNvbnRyYWN0KCkgewoKICAgICAgICBjb250cmFjdAogICAgICAgICAgLmFkZENvbnRyYWN0KHRoaXMuY29udHJhY3QpCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgLy/mt7vliqDmiJDlip8KICAgICAgICAgICAgLy/mj5DnpLrkv6Hmga8KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICLmt7vliqDmiJDlip8iLAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy/lm57liLDliJfooagg6Lev55Sx6Lez6L2sKOmHjeWumuWQkSkKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2NvbnRyYWN0L2xpc3RDb250cmFjdCIgfSk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICAvL+aPkOekuuS/oeaBrwogICAgICAgICAgICAvLyB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgLy8gICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIC8vICAgbWVzc2FnZTogIua3u+WKoOWksei0pSIsCiAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgfSk7CiAgICAgIAogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["saveContract.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"saveContract.vue","sourceRoot":"src/views/contract","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form label-width=\"120px\">\n      <el-form-item label=\"合同编号\">\n        <el-input :span=\"6\" :disabled=\"true\" v-model=\"contract.id\" />\n      </el-form-item>\n      <el-form-item label=\"合同名称\">\n        <el-input v-model=\"contract.name\" />\n      </el-form-item>\n      <el-form-item label=\"签约日期\">\n        <el-date-picker\n          v-model=\"contract.time\"\n          type=\"datetime\"\n          placeholder=\"请选择时间\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n        >\n        </el-date-picker>\n      </el-form-item>\n       <el-form-item label=\"到期时间日期\">\n        <el-date-picker\n          v-model=\"contract.timeout\"\n          type=\"datetime\"\n          placeholder=\"请选择时间\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n        >\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item label=\"选择员工\">\n       <el-select v-model=\"contract.clerkId\" clearable placeholder=\"请选择\">\n          <el-option\n            v-for=\"item in clerkList\"\n            :key=\"item.id\"\n            :label=\"item.name\"\n            :value=\"item.id\"\n          >\n          </el-option>\n        </el-select>\n      </el-form-item>\n\n      <el-form-item label=\"合同照片\">\n        <!-- 头衔缩略图 -->\n        <pan-thumb :image=\"contract.url+''\" />\n        <!-- 文件上传按钮 -->\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-upload\"\n          @click=\"imagecropperShow = true\"\n          >更换图片</el-button\n        >\n        <!--v-show：是否显示上传组件\n        :key：类似于id，如果一个页面多个图片上传控件，可以做区分\n        :url：后台上传的url地址\n        @close：关闭上传组件\n        @crop-upload-success：上传成功后的回调-->\n        <image-cropper\n          v-show=\"imagecropperShow\"\n          :width=\"300\"\n          :height=\"300\"\n          :key=\"imagecropperKey\"\n          url=\"http://localhost:8001/oss/fileoss/uploadOssFile\"\n          field=\"file\"\n          @close=\"close\"\n          @crop-upload-success=\"cropSuccess\"\n        />\n      </el-form-item>\n      <el-form-item>\n        <el-button\n          :disabled=\"saveBtnDisabled\"\n          type=\"primary\"\n          @click=\"saveOrUpdate\"\n          >保存</el-button\n        >\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport contract from \"@/api/contract\";\nimport ImageCropper from \"@/components/ImageCropper\";\nimport PanThumb from \"@/components/PanThumb\";\nimport clerk from \"@/api/clerk\"\nexport default {\n  components: { ImageCropper, PanThumb },\n  data() {\n    return {\n      contract: {},\n      saveBtnDisabled: false, // 保存按钮是否禁用,\n      saveBtnDisabled: false, // 保存按钮是否禁用,\n      imagecropperShow: false, //上传弹窗组件是否显示\n      imagecropperKey: 0, //上传组件的key值   \n      clerkList:null  \n    };\n  },\n  created() {\n    this.init();\n    this.initClerk();\n  },\n  watch: {\n    //监听\n    $route(to, from) {\n      //路由发生变化 方法就会执行\n      this.init();\n    },\n  },\n  methods: {\n    close() {\n      //关闭上传弹框的方法\n      this.imagecropperShow = false;\n      //上传组件初始化\n      this.imagecropperKey = this.imagecropperKey + 1;\n    },\n    //上传成功方法\n    cropSuccess(data) {\n      this.imagecropperShow = false;\n      //上传之后接口返回图片地址\n      console.log(data);\n      this.contract.url = data.url;\n      this.imagecropperKey = this.imagecropperKey + 1;\n    },\n    //初始化\n    init() {\n      //判断路径中是否有id值\n      if (this.$route.params && this.$route.params.id) {\n        const id = this.$route.params.id;\n        this.getContractById(id);\n      } else {\n        //清空表单\n        this.contract = {};\n      }\n    },\n    //查询\n    initClerk() {\n      clerk.getClerkList().then((response) => {\n        this.clerkList = response.data.clerkList;\n      });\n    },\n    //修改\n    updateContract() {\n      contract.updateContract(this.contract).then((response) => {\n        this.$message({\n          type: \"success\",\n          message: \"修改成功!\",\n        });\n        this.$router.push({ path: \"/contract/listContract\" });\n      });\n    },\n    //根据id查询\n    getContractById(id) {\n      contract\n        .getContractById(id)\n        .then((response) => {\n          this.contract = response.data.contract;\n        })\n        .catch((error) => {});\n    },\n    saveOrUpdate() {\n      //判断是修改还是添加\n      //判断路径中是否有id\n      if (this.$route.params && this.$route.params.id) {\n        //修改\n        this.updateContract();\n      } else {\n        //添加\n        this.saveContract();\n      }\n    },\n    //添加\n    saveContract() {\n\n        contract\n          .addContract(this.contract)\n          .then((response) => {\n            //添加成功\n            //提示信息\n            this.$message({\n              type: \"success\",\n              message: \"添加成功\",\n            });\n            //回到列表 路由跳转(重定向)\n            this.$router.push({ path: \"/contract/listContract\" });\n          })\n          .catch((error) => {\n            //提示信息\n            // this.$message({\n            //   type: \"warning\",\n            //   message: \"添加失败\",\n            // });\n          });\n      \n    },\n  },\n};\n</script>\n\n"]}]}