{"remainingRequest":"/Users/xixi/staff_management/vue-element-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xixi/staff_management/vue-element-admin/src/views/announcement/saveAnnouncement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xixi/staff_management/vue-element-admin/src/views/announcement/saveAnnouncement.vue","mtime":1608726456322},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":1608726442352},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/babel-loader/lib/index.js","mtime":1608726441374},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/cache-loader/dist/cjs.js","mtime":1608726442352},{"path":"/Users/xixi/staff_management/vue-element-admin/node_modules/vue-loader/lib/index.js","mtime":1608726455182}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUaW55bWNlRWRpdG9yIGZyb20gIkAvY29tcG9uZW50cy90aW55bWNlIjsKCmltcG9ydCBhbm5vdW5jZW1lbnQgZnJvbSAiQC9hcGkvYW5ub3VuY2VtZW50IjsKaW1wb3J0IG9zcyBmcm9tICJAL2FwaS9vc3MiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgLy/ms6jlhoxUaW55bWNlRWRpdG9y57uE5Lu2CiAgICBUaW55bWNlRWRpdG9yLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFubm91bmNlbWVudDoge30sCiAgICAgIHNhdmVCdG5EaXNhYmxlZDogZmFsc2UsIC8vIOS/neWtmOaMiemSruaYr+WQpuemgeeUqCwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgcmVhbEhlaWdodCgpIHsKICAgICAgcmV0dXJuICgKICAgICAgICAod2luZG93LmlubmVySGVpZ2h0IHx8CiAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCkgLSAyMDAKICAgICAgKTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfSwKICB3YXRjaDogewogICAgLy/nm5HlkKwKICAgICRyb3V0ZSh0bywgZnJvbSkgewogICAgICAvL+i3r+eUseWPkeeUn+WPmOWMliDmlrnms5XlsLHkvJrmiafooYwKICAgICAgdGhpcy5pbml0KCk7CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKCiAgICAvL+WIneWni+WMlgogICAgaW5pdCgpIHsKICAgICAgLy/liKTmlq3ot6/lvoTkuK3mmK/lkKbmnIlpZOWAvAogICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zICYmIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICAgIGNvbnN0IGlkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgICAgIHRoaXMuZ2V0QW5ub3VuY2VtZW50QnlJZChpZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy/muIXnqbrooajljZUKICAgICAgICB0aGlzLmFubm91bmNlbWVudCA9IHt9OwogICAgICB9CiAgICB9LAogICAgLy/kv67mlLkKICAgIHVwZGF0ZUFubm91bmNlbWVudCgpIHsKICAgICAgYW5ub3VuY2VtZW50LnVwZGF0ZUFubm91bmNlbWVudCh0aGlzLmFubm91bmNlbWVudCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnmiJDlip8hIiwKICAgICAgICB9KTsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICIvYW5ub3VuY2VtZW50L2xpc3RBbm5vdW5jZW1lbnQiIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvL+agueaNrmlk5p+l6K+iCiAgICBnZXRBbm5vdW5jZW1lbnRCeUlkKGlkKSB7CiAgICAgIGFubm91bmNlbWVudAogICAgICAgIC5nZXRBbm5vdW5jZW1lbnRCeUlkKGlkKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgdGhpcy5hbm5vdW5jZW1lbnQgPSByZXNwb25zZS5kYXRhLmFubm91bmNlbWVudDsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHt9KTsKICAgIH0sCiAgICBzYXZlT3JVcGRhdGUoKSB7CiAgICAgIC8v5Yik5pat5piv5L+u5pS56L+Y5piv5re75YqgCiAgICAgIC8v5Yik5pat6Lev5b6E5Lit5piv5ZCm5pyJaWQKICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcyAmJiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgICAvL+S/ruaUuQogICAgICAgIHRoaXMudXBkYXRlQW5ub3VuY2VtZW50KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy/mt7vliqAKICAgICAgICB0aGlzLnNhdmVBbm5vdW5jZW1lbnQoKTsKICAgICAgfQogICAgfSwKICAgIC8v5re75YqgCiAgICBzYXZlQW5ub3VuY2VtZW50KCkgewogICAgICBpZiAodGhpcy5hbm5vdW5jZW1lbnQudGl0bGUgPT0gbnVsbCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgbWVzc2FnZTogIuivt+a3u+WKoOagh+mimCIsCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYW5ub3VuY2VtZW50CiAgICAgICAgICAuYWRkQW5ub3VuY2VtZW50KHRoaXMuYW5ub3VuY2VtZW50KQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIC8v5re75Yqg5oiQ5YqfCiAgICAgICAgICAgIC8v5o+Q56S65L+h5oGvCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICBtZXNzYWdlOiAi5re75Yqg5oiQ5YqfIiwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8v5Zue5Yiw5YiX6KGoIOi3r+eUsei3s+i9rCjph43lrprlkJEpCiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogIi9hbm5vdW5jZW1lbnQvbGlzdEFubm91bmNlbWVudCIgfSk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICAvL+aPkOekuuS/oeaBrwogICAgICAgICAgICAvLyB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgLy8gICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIC8vICAgbWVzc2FnZTogIua3u+WKoOWksei0pSIsCiAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["saveAnnouncement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"saveAnnouncement.vue","sourceRoot":"src/views/announcement","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form label-width=\"120px\">\n      <el-form-item label=\"公告标题\">\n        <el-input :span=\"6\" v-model=\"announcement.title\" />\n      </el-form-item>\n      <el-form-item label=\"发布时间\">\n        <el-date-picker\n          v-model=\"announcement.time\"\n          type=\"datetime\"\n          placeholder=\"选择日期时间\"\n          value-format=\"yyyy-MM-dd HH:mm:ss\"\n        >\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item label=\"公告具体内容\">\n        <tinymce-editor\n          id=\"editor\"\n          ref=\"editor\"\n          v-model=\"announcement.content\"\n          :height=\"realHeight\"\n        />\n      </el-form-item>\n      <el-form-item>\n        <el-button\n          :disabled=\"saveBtnDisabled\"\n          type=\"primary\"\n          @click=\"saveOrUpdate\"\n          >保存</el-button\n        >\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport TinymceEditor from \"@/components/tinymce\";\n\nimport announcement from \"@/api/announcement\";\nimport oss from \"@/api/oss\";\nexport default {\n  components: {\n    //注册TinymceEditor组件\n    TinymceEditor,\n  },\n  data() {\n    return {\n      announcement: {},\n      saveBtnDisabled: false, // 保存按钮是否禁用,\n    };\n  },\n  computed: {\n    realHeight() {\n      return (\n        (window.innerHeight ||\n          document.documentElement.clientHeight ||\n          document.body.clientHeight) - 200\n      );\n    },\n  },\n  created() {\n    this.init();\n  },\n  watch: {\n    //监听\n    $route(to, from) {\n      //路由发生变化 方法就会执行\n      this.init();\n    },\n  },\n\n  methods: {\n\n    //初始化\n    init() {\n      //判断路径中是否有id值\n      if (this.$route.params && this.$route.params.id) {\n        const id = this.$route.params.id;\n        this.getAnnouncementById(id);\n      } else {\n        //清空表单\n        this.announcement = {};\n      }\n    },\n    //修改\n    updateAnnouncement() {\n      announcement.updateAnnouncement(this.announcement).then((response) => {\n        this.$message({\n          type: \"success\",\n          message: \"修改成功!\",\n        });\n        this.$router.push({ path: \"/announcement/listAnnouncement\" });\n      });\n    },\n    //根据id查询\n    getAnnouncementById(id) {\n      announcement\n        .getAnnouncementById(id)\n        .then((response) => {\n          this.announcement = response.data.announcement;\n        })\n        .catch((error) => {});\n    },\n    saveOrUpdate() {\n      //判断是修改还是添加\n      //判断路径中是否有id\n      if (this.$route.params && this.$route.params.id) {\n        //修改\n        this.updateAnnouncement();\n      } else {\n        //添加\n        this.saveAnnouncement();\n      }\n    },\n    //添加\n    saveAnnouncement() {\n      if (this.announcement.title == null) {\n        this.$message({\n          type: \"warning\",\n          message: \"请添加标题\",\n        });\n      } else {\n        announcement\n          .addAnnouncement(this.announcement)\n          .then((response) => {\n            //添加成功\n            //提示信息\n            this.$message({\n              type: \"success\",\n              message: \"添加成功\",\n            });\n            //回到列表 路由跳转(重定向)\n            this.$router.push({ path: \"/announcement/listAnnouncement\" });\n          })\n          .catch((error) => {\n            //提示信息\n            // this.$message({\n            //   type: \"warning\",\n            //   message: \"添加失败\",\n            // });\n          });\n      }\n    },\n  },\n};\n</script>\n\n"]}]}